
### **Dependencies in Terraform**

Terraform automatically handles the **order of resource creation** based on dependencies.

---

#### **1. Parallel Execution**

* When resources **don’t depend** on each other, Terraform runs their **API calls in parallel** for efficiency.
  Example:

  ```hcl
  resource "aws_s3_bucket" "a" {}
  resource "aws_s3_bucket" "b" {}
  ```

  → Both buckets are created **simultaneously**.

---

#### **2. Implicit Dependency**

* When one resource **references an attribute** of another, Terraform automatically infers a dependency.
* It ensures the first resource is **created before** the one that depends on it.

Example:

```hcl
resource "aws_s3_bucket" "images" {}

resource "aws_s3_bucket" "images_bkp" {
  tags = {
    Name = "backup-for-${aws_s3_bucket.images.arn}"
  }
}
```

✅ Here:

* `images_bkp` **depends on** `images` because it uses its ARN.
* Terraform **automatically** creates `images` first.

---

#### **3. Explicit Dependency**

* When there’s **no direct reference** between resources, but you still need one to be created before the other,
  use the `depends_on` argument.

Example:

```hcl
resource "aws_s3_bucket" "images" {}

resource "aws_s3_bucket" "images_bkp" {
  depends_on = [
    aws_s3_bucket.images
  ]
}
```

✅ Here:

* Even though there’s no attribute reference, Terraform **waits** for `images` to finish before creating `images_bkp`.

---

#### **Summary**

| Type         | How it’s Created     | Example                               | Terraform Behavior         |
| ------------ | -------------------- | ------------------------------------- | -------------------------- |
| **Implicit** | Attribute reference  | `${aws_s3_bucket.images.arn}`         | Automatically infers order |
| **Explicit** | `depends_on` keyword | `depends_on = [aws_s3_bucket.images]` | Manually enforces order    |

---

**Key Point:**
Terraform’s **graph-based execution plan** automatically orders resources wherever possible —
you only need `depends_on` when **no attribute reference exists** but a dependency still matters.

You can take a look a look at this graph using terraform graph command.
