
### **`count` Meta-Argument in Terraform**

`count` is a **built-in meta property** available to every Terraform resource.
It allows you to **create multiple instances of the same resource** using a simple number.

---

#### **Basic Example**

```hcl
resource "aws_s3_bucket" "b" {
  count  = 3
  bucket = "my-bucket-${count.index}"
}
```

✅ **Explanation:**

* `count = 3` → creates **3 S3 buckets**.
* `count.index` gives the **current index** (starting from `0`).
* Terraform will create:

  ```
  my-bucket-0
  my-bucket-1
  my-bucket-2
  ```

---

#### **Accessing Counted Resources**

Because multiple resources are created, Terraform stores them as a **list**.
You can reference individual items by index:

```hcl
aws_s3_bucket.b[0].id   # first bucket
aws_s3_bucket.b[1].id   # second bucket
```

---

#### **Conditional Count Example**

You can also use `count` for **conditional creation**:

```hcl
variable "create_bucket" {
  type    = bool
  default = true
}

resource "aws_s3_bucket" "optional" {
  count  = var.create_bucket ? 1 : 0
  bucket = "conditional-bucket"
}
```

✅ **If `create_bucket = true` → bucket is created**
❌ **If `false` → resource is skipped**

---

#### **`count` vs `for_each`**

| Feature       | `count`            | `for_each`                  |
| ------------- | ------------------ | --------------------------- |
| Input Type    | Number or List     | Set or Map                  |
| Access        | `count.index`      | `each.key`, `each.value`    |
| Resource Type | Indexed (0,1,2...) | Named (by key/value)        |
| Best for      | Simple duplication | Named, structured resources |

---

✅ **Use `count` for:** simple repeated resources.
✅ **Use `for_each` for:** named or uniquely keyed resources.
