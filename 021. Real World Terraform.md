
## **Real-World Problems Terraform Workspaces Solve**

### **Problem 1: Multiple Environments**

You often have **dev**, **qa**, **staging**, and **prod** environments.
Traditionally, teams create **separate folders**:

```
project/
├── dev/
│   └── main.tf
└── prod/
    └── main.tf
```

### **Issue**

* Code is almost identical → leads to **duplication**.
* Any change needs to be applied in **multiple places**.
* Increases **maintenance overhead** and **chance of drift**.

---

### **Solution → Terraform Workspaces**

Terraform **workspaces** help manage **multiple environments** (dev, qa, prod) **using the same code** but **separate state files**.

---

### **How It Works**

When you apply Terraform, it creates a **state file** (`terraform.tfstate`) that records resource information.
Each **workspace** maintains its **own state file**.

* Default workspace → `default`
* You can create new ones for each environment.

---

### **Common Commands**

| Command                         | Description                                              |
| ------------------------------- | -------------------------------------------------------- |
| `terraform workspace list`      | Lists all workspaces                                     |
| `terraform workspace new qa`    | Creates a new workspace `qa`                             |
| `terraform workspace select qa` | Switches to `qa` workspace                               |
| `terraform workspace show`      | Displays current workspace                               |
| `terraform workspace delete qa` | Deletes a workspace *(must destroy its resources first)* |

---

### **Example**

```hcl
variable "env" {
  default = terraform.workspace
}

resource "aws_s3_bucket" "app_bucket" {
  bucket = "myapp-${var.env}"
}
```



Now:

* If you’re in **dev workspace**, bucket name → `myapp-dev`
* If you’re in **prod workspace**, bucket name → `myapp-prod`
  
### Another Example:
<img width="717" height="86" alt="image" src="https://github.com/user-attachments/assets/46d2c2c9-0462-4980-9930-0ba13b429c28" />

Each environment has:

* Separate resources
* Separate state files
* Shared codebase ✅

---

### **Summary**

| Folder Approach               | Workspace Approach                    |
| ----------------------------- | ------------------------------------- |
| Separate directories per env  | One codebase for all envs             |
| Code duplication              | No duplication                        |
| Harder to maintain            | Easier to manage                      |
| Separate state files manually | Separate states automatically handled |

---

Workspaces = **“Same code, different environments.”**
