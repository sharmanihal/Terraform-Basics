
## **Terraform Modules**

### **What Are Modules?**

Modules are a way to **reuse**, **organize**, and **share** portions of Terraform code.
They help you **avoid repetition** and **structure** your Terraform projects.

Every Terraform configuration has at least one **default module** called the **root module**.

---

### **Root Module**

The **root module** is simply the main directory where you run Terraform commands.
It usually contains:

```
main.tf
variables.tf
outputs.tf
```

Whenever you run:

```
terraform plan
terraform apply
```

Terraform only executes resources in the **root module** (not subfolders unless explicitly imported).

---

### **Creating a Submodule**

Suppose you want to manage S3 buckets separately.

Project structure:

```
project/
├── main.tf
└── modules/
    └── s3-module/
        └── main.tf
```

In `modules/s3-module/main.tf`, write code to create an S3 bucket:

```hcl
resource "aws_s3_bucket" "app_bucket" {
  bucket = "my-app-bucket"
}
```

---

### **Importing the Module in Root**

In your root `main.tf`:

```hcl
module "my_s3_module" {
  source = "./modules/s3-module"
}
```

Now run:

```
terraform init
terraform plan
```

✅ `terraform init` — downloads or initializes modules (including local ones).
✅ `terraform plan` — now includes resources from the imported module.

---

### **Key Notes**

* Terraform **does not automatically pick up** `.tf` files from subfolders — they must be imported using the `module` block.
* A **module can have inputs and outputs**, just like the root module.
* You can use:

  * **Local modules** → `source = "./modules/s3-module"`
  * **Remote modules** → from GitHub, Terraform Registry, or S3 bucket.

---

### **Example Using Input Variable**

Inside `modules/s3-module/main.tf`:

```hcl
variable "bucket_name" {}

resource "aws_s3_bucket" "app_bucket" {
  bucket = var.bucket_name
}
```

Then in root `main.tf`:

```hcl
module "my_s3_module" {
  source      = "./modules/s3-module"
  bucket_name = "project-dev-bucket"
}
```

---

### **Summary**

| Concept              | Meaning                                                     |
| -------------------- | ----------------------------------------------------------- |
| **Root Module**      | The main folder where Terraform commands are run            |
| **Child/Sub Module** | A reusable Terraform configuration stored in another folder |
| **`source`**         | Tells Terraform where to find the module                    |
| **`terraform init`** | Fetches or initializes modules                              |
| **Reusability**      | Modules make your code DRY (Don’t Repeat Yourself)          |

---

**In short:**

> Modules = reusable building blocks of Terraform configuration.
> Root module = main entry point.
> Child modules = reusable components you import into root.
